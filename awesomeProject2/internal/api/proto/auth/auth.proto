syntax="proto3";

package auth;

option go_package="/auth";

service AuthService {
  rpc Register(RegisterReq) returns (RegisterResp) {}
  rpc Login(LoginReq) returns (LoginResp) {}
  rpc Logout(LogoutReq)returns(LogoutResp){}
  rpc DeliverTokenByRPC(DeliverTokenReq) returns (DeliveryResp) {}
  rpc VerifyTokenByRPC(VerifyTokenReq) returns (VerifyResp) {}
  rpc RefreshTokenByRPC(RefreshTokenReq)returns(RefreshResp) {}
  rpc CheckUserBlacklist(CheckUserBlacklistReq) returns (CheckUserBlacklistResp);
}
message RegisterReq {
  string email = 1;
  string password = 2;
  string confirm_password = 3;
}
message RegisterResp {
  int64  user_id = 1;
}

message LoginReq {
  string email= 1;
  string password = 2;
}

message LoginResp {
  int64  user_id = 1;
}
message LogoutReq{
  string access_token=1;
  string refresh_token=2;
  int64 user_id=3;
}
message LogoutResp{
  bool success=1;
}
message DeliverTokenReq {
  int64   user_id= 1;
}
message DeliveryResp {
  string access_token = 1;
  string refresh_token=2;
}
message VerifyTokenReq {
  string access_token = 1;
}
message VerifyResp {
  bool i_valid = 1;
  int64  user_id= 2;
}
message RefreshTokenReq{
  string refresh_token=1;
}
message RefreshResp{
  string access_token =1;
  string refresh_token=2;
}
message CheckUserBlacklistReq{
  int64 user_id = 1;
}
message CheckUserBlacklistResp{
  bool is_blacklisted = 1;
}